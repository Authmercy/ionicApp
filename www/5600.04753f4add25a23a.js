"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5600],{5600:(D,u,a)=>{a.r(u),a.d(u,{AcotePageModule:()=>x});var h=a(6814),p=a(95),c=a(8602),d=a(2692),m=a(5861),o=a(9212),M=a(9862),f=a(8662),v=a(7413),A=a(9145);const y=()=>["/acote"],P=()=>["/list"],L=[{path:"",component:(()=>{var n;class r{constructor(t,i,e,s,g){this.http=t,this.geolocation=i,this.nativeGeocoder=e,this.mapsService=s,this.router=g,this.latitude=0,this.longitude=0,this.cat="map",this.pending=!1,this.liste=[],this.options={timeout:1e4,enableHighAccuracy:!0,maximumAge:3600},this.nativeGeocoderOptions={useLocale:!0,maxResults:5},this.listLat=[],this.listLong=[]}ngOnInit(){var t=this;return(0,m.Z)(function*(){t.mapsService.initMap("bingMap","Apw2frPNDQwenaJt-Qwt5nDdvYBw_wtG0r6PVoFydMmn_o4uMNjCN_4UMzJZow0w"),t.currentPosition=yield t.mapsService.getPosition(),t.AutorLocation=yield t.mapsService.getAutour(),t.mapsService.centerMap(t.currentPosition),t.mapsService.AutourMap(t.AutorLocation),t.mapsService.addMarker(t.currentPosition,"Ma position"),t.mapsService.addMarker2(t.AutorLocation,"AutorLocation"),t.getAutourdemoi(),t.getMap(),t.getList(),t.calculateAndDisplayRoute()})()}getMap(){}getList(){this.cat="list"}getCurrentCoordinates(){this.geolocation.getCurrentPosition().then(t=>{console.log(t),this.latitude=t.coords.latitude,this.longitude=t.coords.longitude,this.getAddress(this.latitude,this.longitude);const i={latitude:t.coords.latitude,longitude:t.coords.longitude};console.log("Get location"),this.mapsService.centerMap(i),this.mapsService.addMarker(new Microsoft.Maps.Location(i.latitude,i.longitude),"Ma Position")}).catch(t=>{console.log("Error getting location",t)})}calculateAndDisplayRoute(){const t=this.mapsService.getMap();if(t&&Microsoft.Maps.Directions&&Microsoft.Maps.Directions.DirectionsManager){const i=new Microsoft.Maps.Directions.DirectionsManager(t),e=new Microsoft.Maps.Directions.Waypoint({location:new Microsoft.Maps.Location(this.currentPosition.latitude,this.currentPosition.longitude)}),s=new Microsoft.Maps.Directions.Waypoint({location:new Microsoft.Maps.Location(40.7128,-74.006)});i.addWaypoint(e),i.addWaypoint(s),i.calculateDirections()}else console.error("Erreur lors du calcul de 'itin\xe9raire : DirectionsManager non disponible.")}getAddress(t,i){this.nativeGeocoder.reverseGeocode(t,i,this.nativeGeocoderOptions).then(e=>{this.address=this.pretifyAddress(e[0]),console.log("Get Adress")}).catch(e=>{alert("Error getting location"+JSON.stringify(e))})}pretifyAddress(t){let i=[],e="";for(let s in t)i.push(t[s]);i.reverse();for(let s in i)i[s].length&&(e+=i[s]+", ");return t.slice(0,-2)}getAutourdemoi(){this.geolocation.getCurrentPosition().then(t=>{console.log(t),this.latitude=t.coords.latitude,this.longitude=t.coords.longitude,this.getAddress(this.latitude,this.longitude),console.log({latitude:t.coords.latitude,longitude:t.coords.longitude}),this.http.get("https://api.geoapify.com/v2/places?categories=commercial.supermarket,commercial.clothing,commercial.food_and_drink,accommodation.hotel&filter=circle:"+this.longitude+","+this.latitude+",5000&bias=proximity:"+this.longitude+","+this.latitude+"&limit=50&apiKey=549757e660ae405c93a95c0ba18a27ee").subscribe(e=>{console.log(e),this.liste=e.features,this.pending=!0,console.log(e.features);for(let s=0;s<50;s++)console.log(e.features[s].geometry.coordinates[1]),this.name=e.features.categories,this.listLat=e.features[s].geometry.coordinates[1],this.listLong=e.features[s].geometry.coordinates[0],this.name=e.features[s].properties.name,console.log(this.listLong,this.listLat),this.mapsService.centerMap(this.AutorLocation),this.mapsService.addMarker2(new Microsoft.Maps.Location(this.listLat,this.listLong),this.name)},e=>{console.log(e)})})}}return(n=r).\u0275fac=function(t){return new(t||n)(o.Y36(M.eN),o.Y36(f.b),o.Y36(v.d),o.Y36(A.Q),o.Y36(d.F0))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-acote"]],decls:16,vars:5,consts:[[1,"ion-no-border"],["slot","start","defaultHref","onglets/accueil"],["justify-content-center",""],[3,"fullscreen"],[1,"container"],["size","6",1,"element"],["color","light",1,"custom-badge",3,"routerLink"],["name","map-outline"],["name","list-outline"],["id","bingMap",2,"height","100%"]],template:function(t,i){1&t&&(o.TgZ(0,"ion-header",0)(1,"ion-toolbar"),o._UZ(2,"ion-back-button",1),o.TgZ(3,"ion-title",2),o._uU(4,"Close to me "),o.qZA()()(),o.TgZ(5,"ion-content",3)(6,"div",4)(7,"ion-col",5)(8,"ion-badge",6),o._UZ(9,"ion-icon",7),o._uU(10," MAP "),o.qZA()(),o.TgZ(11,"ion-col",5)(12,"ion-badge",6),o._UZ(13,"ion-icon",8),o._uU(14,"LIST "),o.qZA()()(),o._UZ(15,"div",9),o.qZA()),2&t&&(o.xp6(5),o.Q6J("fullscreen",!0),o.xp6(3),o.Q6J("routerLink",o.DdM(3,y)),o.xp6(4),o.Q6J("routerLink",o.DdM(4,P)))},dependencies:[c.yp,c.wI,c.W2,c.Gu,c.gu,c.wd,c.sr,c.oU,c.YI,d.rH],styles:["ion-badge[_ngcontent-%COMP%]{padding:8px 0;border-radius:18px;color:#8c8c8c;border:1px solid #8c8c8c;width:100%;text-align:center}ion-icon[_ngcontent-%COMP%]{color:#6874e1}.container[_ngcontent-%COMP%]{display:flex;font-size:10px;padding:3%}"]}),r})()}];let S=(()=>{var n;class r{}return(n=r).\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[d.Bz.forChild(L),d.Bz]}),r})(),x=(()=>{var n;class r{}return(n=r).\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[h.ez,p.u5,c.Pc,S]}),r})()}}]);